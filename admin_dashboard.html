{% extends 'base.html' %}
{% block content %}
<h2>Admin Dashboard</h2>
<p><a class="btn" href="{{ url_for('product_new') }}">Add Product</a></p>
<h3>Products</h3>
<table class="table">
  <tr><th>Name</th><th>Price</th><th>Qty</th><th>Image</th><th>Actions</th></tr>
  {% for p in products %}
    <tr>
      <td>{{ p.name }}</td>
      <td>₱{{ '%.2f'|format(p.price) }}</td>
      <td>{{ p.quantity }}</td>
      <td><img src="{{ p.image_url() }}" style="height:60px;"></td>
      <td>
        <a href="{{ url_for('product_edit', pid=p.id) }}">Edit</a> |
        <form method="post" action="{{ url_for('product_delete', pid=p.id) }}" style="display:inline">
          <button class="btn" onclick="return confirm('Delete product?')">Delete</button>
        </form>
      </td>
    </tr>
  {% else %}
    <tr><td colspan="5">No products</td></tr>
  {% endfor %}
</table>
<h3>Orders</h3>
<table class="table">
  <tr><th>ID</th><th>Product</th><th>Buyer</th><th>Qty</th><th>Total</th><th>Date</th></tr>
  {% for o in orders %}
    <tr>
      <td>{{ o.id }}</td>
      <td>{{ o.product.name }}</td>
      <td>{{ o.buyer.username }}</td>
      <td>{{ o.quantity }}</td>
      <td>₱{{ '%.2f'|format(o.total_price) }}</td>
      <td>{{ o.created_at }}</td>
    </tr>
  {% else %}
    <tr><td colspan="6">No orders</td></tr>
  {% endfor %}
</table>
{% endblock %}
